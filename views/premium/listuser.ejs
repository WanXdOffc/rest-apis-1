
<style>
    /* CSS untuk menengahkan tombol */
    .center-button {
        text-align: center;
        margin-top: 20px; /* Sesuaikan dengan kebutuhan Anda */
    }
    
  </style>
  <!-- [ Pre-loader ] End -->
  <!-- [ Sidebar Menu ] start -->
  <nav class="pc-sidebar">
    <div class="navbar-wrapper">
        <div class="m-header">
            <a href="/docs" class="b-brand text-secondary">
                <!-- ========   Change your logo from here   ============ -->
                <!--<img src="https://herupedia.id/assets/images/logo-dark.svg" />-->
                <span class="hero-text-gradient fs-3 fw-bold">
                    <img src="https://i.ibb.co.com/KDNkssr/IMG-20240603-173706-729.jpg" width="30"> Hosei</span>
                <!--<span class="badge bg-light-success rounded-pill ms-2 theme-version"></span>-->
            </a>
        </div>
        <div class="navbar-content">
                                <div class="card pc-user-card">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <img src="<%= profile %>" alt="user-image" class="user-avtar wid-45 rounded-circle" />
                            </div>
                            <div class="flex-grow-1 ms-3 me-2">
                                <h6 class="mb-0"><%= username %> <i class="fa fa-check-circle blue-text"></i></h6>
                                <small>
                                    MEMBER
                                </small>
                            </div>
                            <a class="btn btn-icon btn-link-secondary avtar-s" data-bs-toggle="collapse" href="#pc_sidebar_userlink">
                                <svg class="pc-icon">
                                    <use xlink:href="#custom-sort-outline"></use>
                                </svg>
                            </a>
                        </div>
                        <div class="collapse pc-user-links" id="pc_sidebar_userlink">
                            <div class="pt-3">
                                <a href="/users/profile">
                                    <i class="fas fa-cog fs-6 ms-2"></i>
                                    <span>Pengaturan</span>
                                </a>
                            </div>
                        <div class="collapse pc-user-links" id="pc_sidebar_userlink">
                            <div class="pt-3">
                                <a href="/users/logout">
                                    <i class="fas fa-sign-out fs-6 ms-2"></i>
                                    <span>Logout</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                            <ul class="pc-navbar">
                <style>
                    .pc-sidebar .pc-link .pc-mtext {
                        vertical-align: middle;
                    }

                    .pc-sidebar .pc-micon i {
                        vertical-align: sub;
                    }
                </style>
                                        <li class="pc-item pc-caption">
                        <label>Main</label>
                        <i class="ti ti-dashboard"></i>
                    </li>
                    <li class="pc-item ">
                        <a href="/admin" class="pc-link">
                            <span class="pc-micon">
                                <i class="fas fa-home"></i>
                            </span>
                            <span class="pc-mtext">Dashboard</span>
                        </a>
                    </li>
                    <li class="pc-item ">
                        <a href="/admin/update" class="pc-link">
                            <span class="pc-micon">
                                <i class="fas fa-user"></i>
                            </span>
                            <span class="pc-mtext">Update Users</span>
                        </a>
                    </li>
                    <li class="pc-item ">
                        <a href="/admin/listuser" class="pc-link">
                            <span class="pc-micon">
                                <i class="fas fa-users"></i>
                            </span>
                            <span class="pc-mtext">List User</span>
                        </a>
                    </li>
                    <li class="pc-item ">
                        <a href="/admin/announcements" class="pc-link">
                            <span class="pc-micon">
                                <i class="fas fa-bullhorn"></i>
                            </span>
                            <span class="pc-mtext">Announcement</span>
                        </a>
                    </li>
                    <li class="pc-item ">
                        <a href="/users/tiket" class="pc-link">
                            <span class="pc-micon">
                                <i class="fas fa-ticket "></i>
                            </span>
                            <span class="pc-mtext">Ticket</span>
                        </a>
                    </li>
                    <li class="pc-item ">
                        <a href="/admin/redeem-code" class="pc-link">
                            <span class="pc-micon">
                                <i class="fas fa-gift "></i>
                            </span>
                            <span class="pc-mtext">Redeem Code</span>
                        </a>
                    </li>
        </div>
    </div>
</nav>
  <!-- [ Sidebar Menu ] end -->
  <!-- [ Header Topbar ] start -->
  <header class="pc-header">
    <div class="header-wrapper">
        <!-- [Mobile Media Block] start -->
        <div class="me-auto pc-mob-drp">
            <ul class="list-unstyled">
                <!-- ======= Menu collapse Icon ===== -->
                <li class="pc-h-item pc-sidebar-collapse">
                    <a href="javascript:;" class="pc-head-link ms-0" id="sidebar-hide">
                        <i class="fa fa-bars"></i>
                    </a>
                </li>
                <li class="pc-h-item pc-sidebar-popup">
                    <a href="javascript:;" class="pc-head-link ms-0" id="mobile-collapse">
                        <i class="fa fa-bars"></i>
                    </a>
                </li>
            </ul>
        </div>
        <!-- [Mobile Media Block end] -->
        <div class="ms-auto">
            <ul class="list-unstyled">
                                        <li class="pc-h-item">
                        <button type="button" class="btn btn-sm btn-secondary me-1" onclick="window.location.href='https://hosei.xyz'"><%= limit %></button>
                    </li>
                    <li class="pc-h-item">
                        <a href="/ class="pc-head-link arrow-none me-0">
                            <svg class="pc-icon text-secondary">
                                <use xlink:href="#custom-sun-1"></use>
                            </svg>
                        </a>
                    </li>
                    <li class="dropdown pc-h-item header-user-profile">
                        <a class="pc-head-link dropdown-toggle arrow-none me-0" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" data-bs-auto-close="outside" aria-expanded="false">
                            <img src="<%= profile %>" alt="user-image" class="user-avtar" />
                        </a>
                        <div class="dropdown-menu dropdown-user-profile dropdown-menu-end pc-h-dropdown">
                            <div class="dropdown-header d-flex align-items-center justify-content-between">
                                <h5 class="m-0">Profile</h5>
                            </div>
                            <div class="dropdown-body pb-2">
                                <div class="profile-notification-scroll position-relative" style="max-height: calc(100vh - 225px)">
                                    <div class="d-flex mb-1">
                                        <div class="flex-shrink-0">
                                            <img src="<%= profile %>" alt="user-image" class="user-avtar wid-35" />
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1"><%= username %> <i class="fa fa-check-circle blue-text"></i></h6>
                                            <span><%= username %> <span class="text-secondary fw-bolder">[MEMBER]</span></span>
                                        </div>
                                    </div>
                                    <a href="/users/profile" class="dropdown-item ">
                                        <span>
                                            <span class="pc-micon">
                                                <i class="fas fa-cog fs-6 me-2"></i>
                                            </span>
                                            <span>Pengaturan</span>
                                        </span>
                                    </a>
                                    <hr class="border-secondary border-opacity-50" />
                                    <div class="d-grid mb-0">
                                        <button class="btn btn-secondary" onclick="confirm_logout();">
                                            <span class="pc-micon">
                                                <i class="fas fa-sign-out fs-6 me-2"></i>
                                            </span>
                                            Logout
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                                </ul>
        </div>
    </div>
  </header>
 <!-- [ Header ] end -->
    <!-- [ Main Content ] start -->
	<div class="pc-container">
        <div class="pc-content">
            <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="/">Hosei APIs</a></li>
                                <li class="breadcrumb-item" aria-current="page">Admin Page</li>
                            </ul>
                        </div>
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <h2 class="mb-0">Admin Page</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="fas fa-users me-2"></i>List Users</h4>
                    </div>
                    <div class="card-body pb-3">
                        <div class="table-responsive">
                            <table class="table">
                                <thead class="text-primary">
                                    <tr>
                                        <th>Username</th>
                                        <th class="text-center">Limit</th>
                                        <th>Status</th>
                                        <th class="text-center">Premium</th>
                                        <th class="text-center">Email</th>
                                        <th class="text-center">Apikey</th>
                                        <th class="text-center">Money</th>
                                        <th class="text-center">Actions</th> <!-- Kolom baru untuk tombol hapus -->
                                    </tr>
                                </thead>
                                <tbody>
                                    <% var userCount = 0; %>
                                    <% var startIdx = (currentPage - 1) * itemsPerPage; %>
                                    <% var endIdx = Math.min(startIdx + itemsPerPage, List.length); %>
                                    <% for(var i = startIdx; i < endIdx; i++) { %>
                                    <tr>
                                        <td><%= List[i].username %></td>
                                        <td style="color: #00f2c3" class="text-center">
                                            <% if (List[i].limit === -1) { %>
                                                Unlimited
                                            <% } else { %>
                                                <%= List[i].limit %>
                                            <% } %>
                                        </td>
                                        <td>
                                            <% if(List[i].status !== null) { %>
                                                Active
                                            <% } else { %>
                                                Not Active
                                            <% } %>
                                        </td>
                                        <td style="color: #00f2c3" class="text-center">
                                            <% if(List[i].premium !== null) { %>
                                                Premium User
                                            <% } else { %>
                                                Free User
                                            <% } %>
                                        </td>
                                        <td><%= List[i].email %></td>
                                        <td><%= List[i].apikey %></td>
                                        <td><%= List[i].money %></td>
                                        <!-- Tombol hapus -->
                                        <td class="text-center">
                                            <button class="btn btn-danger btn-sm" onclick="hapusUser('<%= List[i].username %>')">Hapus</button>
                                        </td>
                                    </tr>
                                    <% userCount++; %>
                                    <% } %>
                                    <tr>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!-- Pagination -->
                        <nav aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <% for(var j = 1; j <= totalPages; j++) { %>
                                    <li class="page-item <%= j === currentPage ? 'active' : '' %>">
                                        <a class="page-link" href="?page=<%= j %>"><%= j %></a>
                                    </li>
                                <% } %>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
            <script>
                function hapusUser(username) {
                    if (confirm("Apakah Anda yakin untuk menghapus pengguna '" + username + "'?")) {
                        Swal.fire({ // Menggunakan SweetAlert
                            title: 'Apakah Anda yakin?',
                            text: "Anda tidak akan dapat mengembalikan ini!",
                            icon: 'warning',
                            showCancelButton: true,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Ya, hapus!',
                            cancelButtonText: 'Batal'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                fetch('/admin/hapus-user', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({ username: username })
                                })
                                .then(response => {
                                    if (response.ok) {
                                        window.location.reload();
                                    } else {
                                        Swal.fire(
                                            'Gagal!',
                                            'Gagal menghapus pengguna.',
                                            'error'
                                        );
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error);
                                    Swal.fire(
                                        'Error!',
                                        'Terjadi kesalahan. Silakan coba lagi.',
                                        'error'
                                    );
                                });
                            }
                        });
                    }
                }
            </script>     
    <!-- [ Main Content ] end -->
    <footer class="pc-footer">
        <div class="footer-wrapper container-fluid d-flex justify-content-center text-center">
            <div class="row">
                <div class="col my-1">
                    <p class="m-0">© 2023 <b><span class="hero-text-gradient">
                                Hosei APIs                            </span></b> - With ♥ by <a href="https://instagram.com/xwan.store_" target="_blank"><b><span class="hero-text-gradient">Darmawan. </span></b></a></p>
                </div>
            </div>
        </div>
    </footer>
    </div>

    <div class="modal fade" id="detail_modal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detail_modal_title"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body pb-3" id="detail_modal_body">
                </div>
            </div>
        </div>
    </div>
    <div class="offcanvas border-0 pct-offcanvas offcanvas-end" tabindex="-1" id="offcanvas_pc_layout">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Pengaturan</h5>
            <button type="button" class="btn btn-icon btn-link-danger" data-bs-dismiss="offcanvas" aria-label="Close"><i class="fa fa-close"></i></button>
        </div>
        <div class="pct-body" style="height: calc(100% - 85px)">
            <div class="offcanvas-body py-0">
                    <input type="hidden" name="csrf_token" value="4a10d3cb93f03a4d13dd642e871c7564" />
                    <input type="hidden" name="theme_mode" id="theme_mode" value="light">
                    <input type="hidden" name="theme_contrast" id="theme_contrast" value="false">
                    <input type="hidden" name="theme_preset" id="theme_preset" value="preset-7">


                    <ul class="list-group list-group-flush">
                        <li class="list-group-item px-0 pt-0">
                            <div class="pc-dark">
                                <h6 class="mb-1">Mode Tema</h6>
                                <p class="text-muted text-sm">Pilih mode terang, gelap atau otomatis</p>
                                <div class="row theme-layout">
                                    <div class="col-4">
                                        <div class="d-grid">
                                            <button type="button" class="preset-btn btn active" data-value="true" onclick="layout_change('light'); layout_change2('light');" data-bs-toggle="tooltip" title="Terang">
                                                <svg class="pc-icon text-warning">
                                                    <use xlink:href="#custom-sun-1"></use>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="d-grid">
                                            <button type="button" class="preset-btn btn" data-value="false" onclick="layout_change('dark'); layout_change2('dark');" data-bs-toggle="tooltip" title="Gelap">
                                                <svg class="pc-icon">
                                                    <use xlink:href="#custom-moon"></use>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="d-grid">
                                            <button type="button" class="preset-btn btn" data-value="default" onclick="layout_change_default(); layout_change2('default');" data-bs-toggle="tooltip" title="Secara otomatis menetapkan tema berdasarkan skema warna sistem operasi pengguna.">
                                                <svg class="pc-icon">
                                                    <use xlink:href="#custom-setting-2"></use>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item px-0">
                            <h6 class="mb-1">Kontras Tema</h6>
                            <p class="text-muted text-sm">Pilih kontras tema</p>
                            <div class="row theme-contrast">
                                <div class="col-6">
                                    <div class="d-grid">
                                        <button type="button" class="preset-btn btn " data-value="true" onclick="layout_sidebar_change('true'); layout_sidebar_change2('true');">
                                            <svg class="pc-icon">
                                                <use xlink:href="#custom-mask"></use>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="d-grid">
                                        <button type="button" class="preset-btn btn active" data-value="false" onclick="layout_sidebar_change('false'); layout_sidebar_change2('false');">
                                            <svg class="pc-icon">
                                                <use xlink:href="#custom-mask-1-outline"></use>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item px-0">
                            <h6 class="mb-1">Kustom Tema</h6>
                            <p class="text-muted text-sm">Pilih warna Utama Anda</p>
                            <div class="theme-color preset-color">
                                <a href="#!" class="" data-value="preset-1" onclick="layout_preset2('preset-1');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-2" onclick="layout_preset2('preset-2');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-3" onclick="layout_preset2('preset-3');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-4" onclick="layout_preset2('preset-4');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-5" onclick="layout_preset2('preset-5');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-6" onclick="layout_preset2('preset-6');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="active" data-value="preset-7" onclick="layout_preset2('preset-7');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-8" onclick="layout_preset2('preset-8');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-9" onclick="layout_preset2('preset-9');"><i class="ti ti-check"></i></a>
                                <a href="#!" class="" data-value="preset-10" onclick="layout_preset2('preset-10');"><i class="ti ti-check"></i></a>
                            </div>
                        </li>
                    </ul>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>